  <agent_config os="Windows">
    <!-- ============================================ -->
    <!-- WAZUH ENTERPRISE CONFIG FOR WINDOWS 2025 DC  -->
    <!-- Version: 4.12.0 - Best Practices 2025        -->
    <!-- Optimized for: Multi-Role Domain Controllers -->
    <!-- Roles: AD, DNS, DHCP, CA, NPS                -->
    <!-- Features: Zero Trust, Advanced Threat Det.   -->
    <!-- ============================================ -->
    <!-- Client Buffer - Optimized for Multi-Role DC high volume -->
    <client_buffer>
      <disabled>no</disabled>
      <queue_size>100000</queue_size>
      <!-- Increased for multi-role DC -->
      <events_per_second>1000</events_per_second>
      <!-- Increased for CA/NPS/DHCP -->
    </client_buffer>
    <!-- Security Configuration Assessment -->
    <sca>
      <enabled>yes</enabled>
      <interval>12h</interval>
      <scan_on_start>yes</scan_on_start>
      <skip_nfs>yes</skip_nfs>
      <policies>
        <policy>ruleset/sca/cis_win2022_dc.yml</policy>
        <!-- Use 2022 until 2025 available -->
        <policy>ruleset/sca/win_audit_rcl.yml</policy>
        <policy>ruleset/sca/cis_win_enterprise.yml</policy>
      </policies>
    </sca>
    <!-- Agent Upgrade - CORRECTED -->
    <agent-upgrade>
      <enabled>yes</enabled>
      <notification_wait_start>60s</notification_wait_start>
      <!-- FIXED: Added 's' suffix -->
      <notification_wait_factor>2</notification_wait_factor>
      <notification_wait_max>2h</notification_wait_max>
      <!-- Can use 2h or 7200s -->
      <ca_verification>
        <enabled>yes</enabled>
        <ca_store>C:\Program Files (x86)\ossec-agent\etc\wpk_root.pem</ca_store>
        <!-- Full path -->
      </ca_verification>
    </agent-upgrade>
    <!-- Rootcheck for Multi-Role DC -->
    <rootcheck>
      <frequency>14400</frequency>
      <!-- Changed to 4 hours for balance -->
      <disabled>no</disabled>
      <check_files>yes</check_files>
      <check_trojans>yes</check_trojans>
      <check_dev>yes</check_dev>
      <check_sys>yes</check_sys>
      <check_pids>yes</check_pids>
      <check_ports>yes</check_ports>
      <check_if>yes</check_if>
      <check_winaudit>yes</check_winaudit>
      <check_winapps>yes</check_winapps>
      <check_winmalware>yes</check_winmalware>
      <rootkit_files>etc/shared/win_applications_rcl.txt</rootkit_files>
      <rootkit_trojans>etc/shared/win_malware_rcl.txt</rootkit_trojans>
      <system_audit>etc/shared/win_audit_rcl.txt</system_audit>
    </rootcheck>
    <!-- Vulnerability Detector -->
    <vulnerability-detector>
      <enabled>yes</enabled>
      <interval>5m</interval>
      <min_full_scan_interval>6h</min_full_scan_interval>
      <run_on_start>yes</run_on_start>
    </vulnerability-detector>
    <!-- Syscollector - System Inventory -->
    <wodle name="syscollector">
      <disabled>no</disabled>
      <interval>6h</interval>
      <scan_on_start>yes</scan_on_start>
      <hardware>yes</hardware>
      <os>yes</os>
      <network>yes</network>
      <packages>yes</packages>
      <ports all="no">yes</ports>
      <processes>yes</processes>
      <hotfixes>yes</hotfixes>
    </wodle>
    <!-- ============================================ -->
    <!-- SYSMON INTEGRATION - CRITICAL DC EVENTS      -->
    <!-- ============================================ -->
    <!-- SYSMON BASE - All Events for Analysis -->
    <localfile>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <log_format>eventchannel</log_format>
    </localfile>
    <!-- SYSMON Event ID 1: Process Creation - Critical Processes Only -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=1)]] and
      Event[EventData[
        (Data[@Name='Image'] and (
          Data[contains(text(),'powershell.exe')] or
          Data[contains(text(),'pwsh.exe')] or
          Data[contains(text(),'cmd.exe')] or
          Data[contains(text(),'wscript.exe')] or
          Data[contains(text(),'cscript.exe')] or
          Data[contains(text(),'mshta.exe')] or
          Data[contains(text(),'rundll32.exe')] or
          Data[contains(text(),'certutil.exe')] or
          Data[contains(text(),'psexec.exe')] or
          Data[contains(text(),'wmic.exe')] or
          Data[contains(text(),'net.exe')] or
          Data[contains(text(),'vssadmin.exe')] or
          Data[contains(text(),'bcdedit.exe')]
        )) or
        (Data[@Name='CommandLine'] and (
          Data[contains(text(),'mimikatz')] or
          Data[contains(text(),'kerberos::golden')] or
          Data[contains(text(),'lsadump::')] or
          Data[contains(text(),'sekurlsa::')] or
          Data[contains(text(),'privilege::debug')] or
          Data[contains(text(),'token::elevate')]
        ))
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 3: Network Connections - Suspicious Only -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=3)]] and
      Event[EventData[
        (Data[@Name='DestinationPort'] and (
          Data[text()='4444'] or
          Data[text()='5985'] or
          Data[text()='5986'] or
          Data[text()='8080'] or
          Data[text()='8443'] or
          Data[text()='1337'] or
          Data[text()='31337']
        )) or
        (Data[@Name='Image'] and (
          Data[contains(text(),'powershell.exe')] or
          Data[contains(text(),'pwsh.exe')] or
          Data[contains(text(),'cmd.exe')]
        ))
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 7: DLL Loaded - Critical Process Injection -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=7)]] and
      Event[EventData[
        (Data[@Name='Image'] and (
          Data[contains(text(),'lsass.exe')] or
          Data[contains(text(),'winlogon.exe')] or
          Data[contains(text(),'services.exe')] or
          Data[contains(text(),'csrss.exe')]
        )) and
        (Data[@Name='ImageLoaded'] and not(
          Data[contains(text(),'C:\Windows\System32\')] or
          Data[contains(text(),'C:\Windows\SysWOW64\')]
        ))
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 8: CreateRemoteThread - Credential Theft -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=8)]] and
      Event[EventData[
        Data[@Name='TargetImage'] and (
          Data[contains(text(),'lsass.exe')] or
          Data[contains(text(),'winlogon.exe')] or
          Data[contains(text(),'csrss.exe')]
        )
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 10: Process Access - LSASS Access (Mimikatz Detection) -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=10)]] and
      Event[EventData[
        Data[@Name='TargetImage'] and Data[contains(text(),'lsass.exe')]
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 11: File Creation - Executables in Suspicious Locations -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=11)]] and
      Event[EventData[
        Data[@Name='TargetFilename'] and (
          (Data[contains(text(),'C:\Windows\Temp\')] and Data[contains(text(),'.exe')]) or
          (Data[contains(text(),'C:\ProgramData\')] and Data[contains(text(),'.exe')]) or
          (Data[contains(text(),'C:\Users\Public\')] and Data[contains(text(),'.exe')]) or
          Data[contains(text(),'C:\Windows\SYSVOL\')] or
          Data[contains(text(),'C:\Windows\NTDS\')]
        )
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event IDs 12-14: Registry Persistence Mechanisms -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=12 or EventID=13 or EventID=14)]] and
      Event[EventData[
        Data[@Name='TargetObject'] and (
          Data[contains(text(),'CurrentVersion\Run')] or
          Data[contains(text(),'CurrentVersion\RunOnce')] or
          Data[contains(text(),'Winlogon\Shell')] or
          Data[contains(text(),'Winlogon\Userinit')] or
          Data[contains(text(),'Services\NTDS')] or
          Data[contains(text(),'Services\DNS')] or
          Data[contains(text(),'Services\CertSvc')] or
          Data[contains(text(),'Services\DHCPServer')] or
          Data[contains(text(),'Services\IAS')] or
          Data[contains(text(),'Control\Lsa')] or
          Data[contains(text(),'Control\SecurityProviders')] or
          Data[contains(text(),'Image File Execution Options')]
        )
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 15: FileCreateStreamHash - Alternate Data Streams -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=15)]]
    </query>
    </localfile>
    <!-- SYSMON Event IDs 17-18: Pipe Events - Named Pipe Backdoors -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=17 or EventID=18)]] and
      Event[EventData[
        Data[@Name='PipeName'] and (
          Data[contains(text(),'isapi_http')] or
          Data[contains(text(),'acsipc')] or
          Data[contains(text(),'winsock')] or
          Data[contains(text(),'msagent')] or
          Data[contains(text(),'PSEXESVC')] or
          Data[contains(text(),'postex')] or
          Data[contains(text(),'status_')]
        )
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event IDs 19-21: WMI Activity -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=19 or EventID=20 or EventID=21)]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 22: DNS Query - C2 Detection -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=22)]] and
      Event[EventData[
        (Data[@Name='QueryName'] and (
          Data[contains(text(),'.tk')] or
          Data[contains(text(),'.ml')] or
          Data[contains(text(),'.ga')] or
          Data[contains(text(),'.cf')] or
          Data[contains(text(),'pastebin.com')] or
          Data[contains(text(),'githubusercontent.com')]
        )) or
        (Data[@Name='Image'] and not(
          Data[contains(text(),'chrome.exe')] or
          Data[contains(text(),'firefox.exe')] or
          Data[contains(text(),'edge.exe')] or
          Data[contains(text(),'iexplore.exe')]
        ))
      ]]
    </query>
    </localfile>
    <!-- SYSMON Event ID 25: Process Tampering - Anti-Detection -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <query>
      Event[System[(EventID=25)]]
    </query>
    </localfile>
    <!-- ============================================ -->
    <!-- ACTIVE DIRECTORY SECURITY EVENTS             -->
    <!-- ============================================ -->
    <!-- Security Events - Comprehensive DC Monitoring -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Security</location>
      <!-- Keep existing comprehensive query - it's good -->
      <query>
      Event[System[(EventID=1102 or EventID=4618 or EventID=4649 or EventID=4719 or
                   EventID=4624 or EventID=4625 or EventID=4634 or EventID=4648 or 
                   EventID=4672 or EventID=4673 or EventID=4674 or EventID=4688 or
                   EventID=4697 or EventID=4698 or EventID=4699 or EventID=4700 or 
                   EventID=4701 or EventID=4702 or EventID=4703 or EventID=4704 or
                   EventID=4705 or EventID=4706 or EventID=4707 or EventID=4713 or
                   EventID=4714 or EventID=4715 or EventID=4716 or EventID=4717 or
                   EventID=4718 or EventID=4719 or EventID=4720 or EventID=4722 or 
                   EventID=4723 or EventID=4724 or EventID=4725 or EventID=4726 or
                   EventID=4727 or EventID=4728 or EventID=4729 or EventID=4730 or 
                   EventID=4731 or EventID=4732 or EventID=4733 or EventID=4734 or
                   EventID=4735 or EventID=4737 or EventID=4738 or EventID=4739 or 
                   EventID=4740 or EventID=4741 or EventID=4742 or EventID=4743 or
                   EventID=4744 or EventID=4745 or EventID=4746 or EventID=4747 or 
                   EventID=4748 or EventID=4749 or EventID=4750 or EventID=4751 or
                   EventID=4752 or EventID=4753 or EventID=4754 or EventID=4755 or 
                   EventID=4756 or EventID=4757 or EventID=4758 or EventID=4759 or
                   EventID=4760 or EventID=4761 or EventID=4762 or EventID=4763 or 
                   EventID=4764 or EventID=4765 or EventID=4766 or EventID=4767 or
                   EventID=4768 or EventID=4769 or EventID=4770 or EventID=4771 or 
                   EventID=4772 or EventID=4773 or EventID=4774 or EventID=4775 or
                   EventID=4776 or EventID=4777 or EventID=4778 or EventID=4779 or 
                   EventID=4780 or EventID=4781 or EventID=4782 or EventID=4783 or
                   EventID=4784 or EventID=4785 or EventID=4786 or EventID=4787 or 
                   EventID=4788 or EventID=4789 or EventID=4790 or EventID=4791 or
                   EventID=4792 or EventID=4793 or EventID=4794 or EventID=4798 or 
                   EventID=4799 or EventID=4800 or EventID=4801 or EventID=4802 or
                   EventID=4803 or EventID=4816 or EventID=4817 or EventID=4818 or
                   EventID=4819 or EventID=4820 or EventID=4821 or EventID=4822 or
                   EventID=4823 or EventID=4824 or EventID=4825 or EventID=4826 or
                   EventID=4864 or EventID=4865 or EventID=4866 or EventID=4867 or
                   EventID=4868 or EventID=4869 or EventID=4870 or EventID=4871 or
                   EventID=4872 or EventID=4873 or EventID=4874 or EventID=4875 or
                   EventID=4876 or EventID=4877 or EventID=4878 or EventID=4879 or
                   EventID=4880 or EventID=4881 or EventID=4882 or EventID=4883 or
                   EventID=4884 or EventID=4885 or EventID=4886 or EventID=4887 or
                   EventID=4888 or EventID=4889 or EventID=4890 or EventID=4891 or
                   EventID=4892 or EventID=4893 or EventID=4894 or EventID=4895 or
                   EventID=4896 or EventID=4897 or EventID=4898 or EventID=4899 or
                   EventID=4900 or EventID=4902 or EventID=4904 or EventID=4905 or
                   EventID=4906 or EventID=4907 or EventID=4908 or EventID=4909 or
                   EventID=4910 or EventID=4911 or EventID=4912 or EventID=4928 or
                   EventID=4929 or EventID=4930 or EventID=4931 or EventID=4932 or
                   EventID=4933 or EventID=4934 or EventID=4935 or EventID=4936 or
                   EventID=4937 or EventID=4944 or EventID=4945 or EventID=4946 or
                   EventID=4947 or EventID=4948 or EventID=4949 or EventID=4950 or
                   EventID=4951 or EventID=4952 or EventID=4953 or EventID=4954 or
                   EventID=4956 or EventID=4957 or EventID=4958 or EventID=4960 or
                   EventID=4961 or EventID=4962 or EventID=4963 or EventID=4964 or
                   EventID=4965 or EventID=4976 or EventID=4977 or EventID=4978 or
                   EventID=4979 or EventID=4980 or EventID=4981 or EventID=4982 or
                   EventID=4983 or EventID=4984 or EventID=4985 or EventID=5024 or
                   EventID=5025 or EventID=5027 or EventID=5028 or EventID=5029 or
                   EventID=5030 or EventID=5031 or EventID=5032 or EventID=5033 or
                   EventID=5034 or EventID=5035 or EventID=5037 or EventID=5038 or
                   EventID=5039 or EventID=5040 or EventID=5041 or EventID=5042 or
                   EventID=5043 or EventID=5044 or EventID=5045 or EventID=5046 or
                   EventID=5047 or EventID=5048 or EventID=5049 or EventID=5050 or
                   EventID=5051 or EventID=5056 or EventID=5057 or EventID=5058 or
                   EventID=5059 or EventID=5060 or EventID=5061 or EventID=5062 or
                   EventID=5136 or EventID=5137 or EventID=5138 or EventID=5139 or
                   EventID=5140 or EventID=5141 or EventID=5142 or EventID=5143 or
                   EventID=5144 or EventID=5145 or EventID=5146 or EventID=5147 or
                   EventID=5148 or EventID=5149 or EventID=5150 or EventID=5151 or
                   EventID=5152 or EventID=5153 or EventID=5154 or EventID=5155 or
                   EventID=5156 or EventID=5157 or EventID=5158 or EventID=5159 or
                   EventID=5168 or EventID=5169 or EventID=5170 or EventID=5376 or
                   EventID=5377 or EventID=5378 or EventID=5379 or EventID=5380 or
                   EventID=5381 or EventID=5382 or EventID=5440 or EventID=5441 or
                   EventID=5442 or EventID=5443 or EventID=5444 or EventID=5445 or
                   EventID=5446 or EventID=5447 or EventID=5448 or EventID=5449 or
                   EventID=5450 or EventID=5451 or EventID=5452 or EventID=5453 or
                   EventID=5456 or EventID=5457 or EventID=5458 or EventID=5459 or
                   EventID=5460 or EventID=5461 or EventID=5462 or EventID=5463 or
                   EventID=5464 or EventID=5465 or EventID=5466 or EventID=5467 or
                   EventID=5468 or EventID=5471 or EventID=5472 or EventID=5473 or
                   EventID=5474 or EventID=5477 or EventID=5478 or EventID=5479 or
                   EventID=5480 or EventID=5483 or EventID=5484 or EventID=5485 or
                   EventID=5632 or EventID=5633 or EventID=5712 or EventID=5888 or
                   EventID=5889 or EventID=5890 or EventID=6144 or EventID=6145 or
                   EventID=6272 or EventID=6273 or EventID=6274 or EventID=6275 or
                   EventID=6276 or EventID=6277 or EventID=6278 or EventID=6279 or
                   EventID=6280 or EventID=6281 or EventID=6400 or EventID=6401 or
                   EventID=6402 or EventID=6403 or EventID=6404 or EventID=6405 or
                   EventID=6406 or EventID=6407 or EventID=6408 or EventID=6409 or
                   EventID=6410 or EventID=6416 or EventID=6417 or EventID=6418 or
                   EventID=6419 or EventID=6420 or EventID=6421 or EventID=6422 or
                   EventID=6423 or EventID=6424 or EventID=8222)]]
    </query>
    </localfile>
    <!-- System Events -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>System</location>
      <query>
      Event[System[(EventID=1074 or EventID=6005 or EventID=6006 or EventID=6008 or 
                   EventID=7022 or EventID=7023 or EventID=7024 or EventID=7026 or
                   EventID=7031 or EventID=7032 or EventID=7034 or EventID=7035 or 
                   EventID=7036 or EventID=7040 or EventID=7045 or EventID=104 or
                   EventID=1001 or EventID=1002)]]
    </query>
    </localfile>
    <!-- Active Directory Service -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Directory Service</location>
      <query>
      Event[System[(Level=1 or Level=2 or Level=3 or
                   EventID=1083 or EventID=1119 or EventID=1173 or EventID=1202 or
                   EventID=1220 or EventID=1265 or EventID=1311 or EventID=1325 or
                   EventID=1388 or EventID=1480 or EventID=1539 or EventID=1586 or
                   EventID=1644 or EventID=1645 or EventID=1646 or EventID=1647 or
                   EventID=1648 or EventID=1649 or EventID=1650 or EventID=1651 or
                   EventID=1652 or EventID=1653 or EventID=1654 or EventID=1655 or
                   EventID=1656 or EventID=1657 or EventID=1658 or EventID=1659 or
                   EventID=1660 or EventID=1661 or EventID=1662 or EventID=1663 or
                   EventID=1664 or EventID=1665 or EventID=1666 or EventID=1667 or
                   EventID=1668 or EventID=1669 or EventID=1670 or EventID=1671 or
                   EventID=1672 or EventID=1673 or EventID=1674 or EventID=1675 or
                   EventID=1676 or EventID=1677 or EventID=1678 or EventID=1679 or
                   EventID=1680 or EventID=1681 or EventID=1682 or EventID=1683 or
                   EventID=1684 or EventID=1685 or EventID=1686 or EventID=1687 or
                   EventID=1688 or EventID=1689 or EventID=1690 or EventID=1691 or
                   EventID=1692 or EventID=1693 or EventID=1694 or EventID=1695 or
                   EventID=1696 or EventID=1697 or EventID=1698 or EventID=1699 or
                   EventID=1865 or EventID=1938 or EventID=1988 or EventID=2041 or
                   EventID=2042 or EventID=2087 or EventID=2088 or EventID=2089 or
                   EventID=2103 or EventID=2108 or EventID=2183 or EventID=2184 or
                   EventID=2886 or EventID=2887 or EventID=2888 or EventID=2889)]]
    </query>
    </localfile>
    <!-- DNS Server -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>DNS Server</location>
      <query>
      Event[System[(Level=1 or Level=2 or Level=3 or
                   EventID=150 or EventID=770 or EventID=3150 or EventID=4013 or
                   EventID=4015 or EventID=4016 or EventID=6001 or EventID=6004)]]
    </query>
    </localfile>
    <!-- ============================================ -->
    <!-- DHCP SERVER MONITORING - NEW                 -->
    <!-- ============================================ -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>DhcpServer</location>
      <query>
      Event[System[(EventID=1020 or EventID=1063 or EventID=1044 or EventID=1046 or
                   EventID=1059 or EventID=1060 or EventID=1061 or EventID=1062 or
                   EventID=1063 or EventID=1064)]]
    </query>
    </localfile>
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-DHCP-Server/Operational</location>
    </localfile>
    <!-- ============================================ -->
    <!-- NPS (RADIUS) MONITORING - NEW                -->
    <!-- ============================================ -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>System</location>
      <query>
      Event[System[Provider[@Name='NPS'] and 
                  (EventID=6272 or EventID=6273 or EventID=6274 or EventID=6275 or
                   EventID=6276 or EventID=6277 or EventID=6278 or EventID=6279 or
                   EventID=6280)]]
    </query>
    </localfile>
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Security</location>
      <query>
      Event[System[(EventID &gt;= 6272 and EventID &lt;= 6280)]]
    </query>
    </localfile>
    <!-- ============================================ -->
    <!-- CERTIFICATE AUTHORITY ENHANCED - NEW         -->
    <!-- ============================================ -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Application</location>
      <query>
      Event[System[Provider[@Name='Microsoft-Windows-CertificationAuthority'] and
                  (EventID=4868 or EventID=4869 or EventID=4870 or EventID=4871 or
                   EventID=4872 or EventID=4873 or EventID=4874 or EventID=4875 or
                   EventID=4876 or EventID=4877 or EventID=4878 or EventID=4879 or
                   EventID=4880 or EventID=4881 or EventID=4882 or EventID=4883 or
                   EventID=4884 or EventID=4885 or EventID=4886 or EventID=4887 or
                   EventID=4888 or EventID=4889 or EventID=4890)]]
    </query>
    </localfile>
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-CertificationAuthority/Operational</location>
    </localfile>
    <!-- DFS Replication -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>DFS Replication</location>
      <query>
      Event[System[(Level=1 or Level=2 or Level=3 or
                   EventID=1202 or EventID=1206 or EventID=1210 or EventID=1232 or
                   EventID=1308 or EventID=2212 or EventID=2218 or EventID=4012 or
                   EventID=4102 or EventID=4202 or EventID=4208 or EventID=4302 or
                   EventID=4304 or EventID=4312 or EventID=4412 or EventID=4512 or
                   EventID=4602 or EventID=4604 or EventID=5002 or EventID=5004 or
                   EventID=5008 or EventID=5012 or EventID=5014 or EventID=5016 or
                   EventID=5102 or EventID=6002 or EventID=6102 or EventID=6104 or
                   EventID=6106 or EventID=6108 or EventID=6110 or EventID=6112 or
                   EventID=6202 or EventID=6302 or EventID=6304 or EventID=6306 or
                   EventID=6308 or EventID=6402 or EventID=6404 or EventID=6406 or
                   EventID=6408 or EventID=6410 or EventID=6412 or EventID=6602 or
                   EventID=6702 or EventID=6704 or EventID=6706 or EventID=6708 or
                   EventID=6800 or EventID=6802 or EventID=6804)]]
    </query>
    </localfile>
    <!-- Key Distribution Center -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>System</location>
      <query>
      Event[System[Provider[@Name='Microsoft-Windows-Kerberos-Key-Distribution-Center'] and
                  (Level=1 or Level=2 or Level=3)]]
    </query>
    </localfile>
    <!-- NTLM Authentication -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-NTLM/Operational</location>
    </localfile>
    <!-- LSA -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-LSA/Operational</location>
    </localfile>
    <!-- PowerShell - DC Specific -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-PowerShell/Operational</location>
      <query>
      Event[System[(EventID=4103 or EventID=4104 or EventID=4105 or EventID=4106)]]
    </query>
    </localfile>
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Windows PowerShell</location>
      <query>
      Event[System[(EventID=400 or EventID=403 or EventID=600 or EventID=800)]]
    </query>
    </localfile>
    <!-- Windows Defender -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Windows Defender/Operational</location>
      <query>
      Event[System[(EventID=1006 or EventID=1007 or EventID=1008 or EventID=1009 or
                   EventID=1010 or EventID=1011 or EventID=1012 or EventID=1013 or
                   EventID=1015 or EventID=1116 or EventID=1117 or EventID=1118 or
                   EventID=1119 or EventID=5001 or EventID=5004 or EventID=5007 or
                   EventID=5010 or EventID=5012)]]
    </query>
    </localfile>
    <!-- ADFS if installed -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>AD FS/Admin</location>
      <query>
      Event[System[(Level=1 or Level=2 or Level=3)]]
    </query>
    </localfile>
    <!-- Group Policy -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-GroupPolicy/Operational</location>
      <query>
      Event[System[(EventID=4016 or EventID=4017 or EventID=5016 or EventID=5017 or
                   EventID=5126 or EventID=5127 or EventID=5257 or EventID=5308 or
                   EventID=5309 or EventID=5310 or EventID=5311 or EventID=5312 or
                   EventID=5313 or EventID=5314 or EventID=5315 or EventID=5316 or
                   EventID=5317 or EventID=5320 or EventID=5321 or EventID=5322 or
                   EventID=5323 or EventID=5324 or EventID=5325 or EventID=5326 or
                   EventID=5327 or EventID=6144 or EventID=6145 or EventID=7016 or
                   EventID=7017 or EventID=7018 or EventID=7019 or EventID=7020 or
                   EventID=7021 or EventID=7022 or EventID=7023 or EventID=7024 or
                   EventID=7025 or EventID=7026 or EventID=7027 or EventID=7028 or
                   EventID=7029 or EventID=7030 or EventID=7031 or EventID=7032 or
                   EventID=7033 or EventID=7034 or EventID=7035 or EventID=7036 or
                   EventID=7037 or EventID=7038 or EventID=7039 or EventID=7040 or
                   EventID=7041 or EventID=7042 or EventID=7043 or EventID=7044 or
                   EventID=7045 or EventID=7046 or EventID=7047 or EventID=7048 or
                   EventID=7049 or EventID=7050 or EventID=7051 or EventID=7052 or
                   EventID=7053 or EventID=7054 or EventID=7055 or EventID=7056 or
                   EventID=7057 or EventID=7058 or EventID=7059 or EventID=7060 or
                   EventID=7061 or EventID=7062 or EventID=7063 or EventID=7064 or
                   EventID=7065 or EventID=7066 or EventID=7067 or EventID=7068 or
                   EventID=7069 or EventID=7070 or EventID=7071 or EventID=7072 or
                   EventID=7073 or EventID=7074 or EventID=7075 or EventID=7076 or
                   EventID=7077 or EventID=7078 or EventID=7079 or EventID=7080 or
                   EventID=7081 or EventID=7082 or EventID=7083 or EventID=7084 or
                   EventID=7085 or EventID=7086 or EventID=7087 or EventID=7088 or
                   EventID=7089 or EventID=7090 or EventID=7091 or EventID=7092 or
                   EventID=7093 or EventID=7094 or EventID=7095 or EventID=7096 or
                   EventID=7097 or EventID=7098 or EventID=7099 or EventID=7100)]]
    </query>
    </localfile>
    <!-- WMI Activity -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-WMI-Activity/Operational</location>
      <query>
      Event[System[(EventID=5857 or EventID=5858 or EventID=5859 or 
                   EventID=5860 or EventID=5861)]]
    </query>
    </localfile>
    <!-- Security Mitigations -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Security-Mitigations/Audit</location>
    </localfile>
    <!-- Code Integrity -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-CodeIntegrity/Operational</location>
      <query>
      Event[System[(EventID=3001 or EventID=3002 or EventID=3003 or 
                   EventID=3004 or EventID=3010 or EventID=3023)]]
    </query>
    </localfile>
    <!-- Task Scheduler -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-TaskScheduler/Operational</location>
      <query>
      Event[System[(EventID=106 or EventID=129 or EventID=141 or 
                   EventID=142 or EventID=200 or EventID=201)]]
    </query>
    </localfile>
    <!-- Windows Firewall -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Windows Firewall With Advanced Security/Firewall</location>
      <query>
      Event[System[(EventID=2003 or EventID=2004 or EventID=2005 or 
                   EventID=2006 or EventID=2033)]]
    </query>
    </localfile>
    <!-- Terminal Services -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-TerminalServices-LocalSessionManager/Operational</location>
      <query>
      Event[System[(EventID=21 or EventID=22 or EventID=23 or 
                   EventID=24 or EventID=25 or EventID=39 or EventID=40)]]
    </query>
    </localfile>
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-TerminalServices-RdpCoreTS/Operational</location>
    </localfile>
    <!-- BITS for potential data exfiltration -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-Bits-Client/Operational</location>
      <query>
      Event[System[(EventID=59 or EventID=60 or EventID=61)]]
    </query>
    </localfile>
    <!-- DNS Client -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Microsoft-Windows-DNS-Client/Operational</location>
      <query>
      Event[System[(EventID=3008)]]
    </query>
    </localfile>
    <!-- Application -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Application</location>
      <query>
      Event[System[(EventID=1000 or EventID=1001 or EventID=1002) and 
                  (Level=1 or Level=2)]]
    </query>
    </localfile>
    <!-- ESET or other AV -->
    <localfile>
      <log_format>eventchannel</log_format>
      <location>Application</location>
      <query>
      Event[System[Provider[@Name='ESET' or @Name='ESET Endpoint Antivirus' or 
                            @Name='ESET PROTECT' or @Name='Symantec Endpoint Protection' or
                            @Name='McAfee' or @Name='Sophos' or @Name='Kaspersky']] and
                  (Level=1 or Level=2 or Level=3)]
    </query>
    </localfile>
    <!-- ============================================ -->
    <!-- FILE INTEGRITY MONITORING FOR DC             -->
    <!-- ============================================ -->
    <syscheck>
      <frequency>43200</frequency>
      <!-- 12 hours -->
      <scan_on_start>no</scan_on_start>
      <auto_ignore frequency="10" timeframe="3600">yes</auto_ignore>
      <process_priority>10</process_priority>
      <max_eps>100</max_eps>
      <synchronization>
        <enabled>yes</enabled>
        <interval>5m</interval>
        <max_interval>1h</max_interval>
      </synchronization>
      <file_limit>
        <enabled>yes</enabled>
        <entries>300000</entries>
        <!-- Increased for multi-role -->
      </file_limit>
      <!-- Critical DC Directories -->
      <directories check_all="yes" realtime="yes" report_changes="yes">%WINDIR%\NTDS</directories>
      <directories check_all="yes" realtime="yes" recursion_level="3">%WINDIR%\SYSVOL</directories>
      <directories check_all="yes" realtime="yes">%WINDIR%\System32\config</directories>
      <directories check_all="yes" realtime="yes">%WINDIR%\System32\drivers\etc</directories>
      <directories check_all="yes" recursion_level="2">%WINDIR%\System32\GroupPolicy</directories>
      <directories check_all="yes">%WINDIR%\System32\dns</directories>
      <!-- Certificate Authority Directories - NEW -->
      <directories check_all="yes" realtime="yes">%WINDIR%\System32\CertSrv</directories>
      <directories check_all="yes" realtime="yes">%WINDIR%\System32\CertLog</directories>
      <directories check_all="yes" realtime="yes">C:\CertData</directories>
      <!-- DHCP Server Directories - NEW -->
      <directories check_all="yes" realtime="yes">%WINDIR%\System32\dhcp</directories>
      <!-- NPS Directories - NEW -->
      <directories check_all="yes" realtime="yes">%WINDIR%\System32\ias</directories>
      <directories check_all="yes" realtime="yes">%WINDIR%\System32\LogFiles\IAS</directories>
      <!-- System binaries -->
      <directories check_all="yes" realtime="yes">%WINDIR%\System32</directories>
      <directories check_all="yes" realtime="yes">%WINDIR%\SysWOW64</directories>
      <!-- Admin Tools -->
      <directories check_all="yes" realtime="yes">%PROGRAMFILES%\Support Tools</directories>
      <directories check_all="yes" realtime="yes">%PROGRAMFILES%\Resource Kit</directories>
      <!-- Critical Registry Keys for Multi-Role DC -->
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\NTDS</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\DNS</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\DHCPServer</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IAS</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\CertSvc</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\DFSR</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\IsmServ</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Kdc</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanServer</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanWorkstation</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Netlogon</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurityProviders</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Policies</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Security\Policy</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Security\SAM</windows_registry>
      <!-- Standard Security Registry Keys -->
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Classes\exefile\shell\open\command</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Classes\comfile\shell\open\command</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Classes\batfile\shell\open\command</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Classes\htafile\shell\open\command</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Classes\piffile\shell\open\command</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Active Setup\Installed Components</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</windows_registry>
      <!-- Comprehensive Exclusions -->
      <ignore>%WINDIR%\Temp</ignore>
      <ignore>%WINDIR%\WinSxS</ignore>
      <ignore>%WINDIR%\SoftwareDistribution</ignore>
      <ignore>%WINDIR%\Logs</ignore>
      <ignore>%WINDIR%\debug</ignore>
      <ignore>%WINDIR%\Prefetch</ignore>
      <ignore>%WINDIR%\System32\LogFiles</ignore>
      <ignore>%WINDIR%\System32\winevt\Logs</ignore>
      <ignore>%WINDIR%\System32\wbem\Logs</ignore>
      <ignore>%WINDIR%\System32\wbem\Performance</ignore>
      <ignore>%WINDIR%\System32\wbem\AutoRecover</ignore>
      <ignore>%WINDIR%\System32\config\systemprofile\AppData</ignore>
      <ignore>%WINDIR%\ServiceProfiles</ignore>
      <ignore>%WINDIR%\System32\dns\backup</ignore>
      <ignore>%WINDIR%\System32\dns\samples</ignore>
      <ignore>%WINDIR%\System32\dhcp\backup</ignore>
      <ignore>%WINDIR%\Installer</ignore>
      <ignore>%WINDIR%\CSC</ignore>
      <ignore>%WINDIR%\assembly\temp</ignore>
      <ignore>%WINDIR%\assembly\tmp</ignore>
      <ignore>C:\ProgramData\Microsoft\Windows Defender</ignore>
      <ignore>C:\ProgramData\Microsoft\Windows\WER</ignore>
      <ignore>C:\ProgramData\Microsoft\Diagnosis</ignore>
      <ignore>C:\ProgramData\Microsoft\Search</ignore>
      <ignore>C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</ignore>
      <ignore>C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</ignore>
      <ignore>C:\System Volume Information</ignore>
      <ignore>C:\Program Files (x86)\ossec-agent</ignore>
      <ignore>C:\Program Files\Windows Defender Advanced Threat Protection</ignore>
      <ignore>C:\pagefile.sys</ignore>
      <ignore>C:\hiberfil.sys</ignore>
      <ignore>C:\swapfile.sys</ignore>
      <!-- NTDS specific exclusions -->
      <ignore type="sregex">ntds\.dit$</ignore>
      <ignore type="sregex">\.log$|\.jrs$|\.chk$|\.edb$</ignore>
      <!-- File type exclusions -->
      <ignore type="sregex">\.tmp$|\.temp$|\.bak$|\.old$|\.etl$|\.evtx$</ignore>
      <!-- No diff for these -->
      <nodiff type="sregex">\.txt$|\.ini$|\.conf$|\.config$|\.xml$|\.pol$</nodiff>
      <alert_new_files>yes</alert_new_files>
    </syscheck>
    <!-- ============================================ -->
    <!-- OSQUERY INTEGRATION                          -->
    <!-- ============================================ -->
    <wodle name="osquery">
      <disabled>yes</disabled>
      <!-- Enable if osquery is installed -->
      <run_daemon>yes</run_daemon>
      <bin_path>C:\Program Files\osquery\osqueryd\osqueryd.exe</bin_path>
      <log_path>C:\Program Files\osquery\log\osqueryd.results.log</log_path>
      <config_path>C:\Program Files\osquery\osquery.conf</config_path>
      <add_labels>yes</add_labels>
    </wodle>
    <!-- ============================================ -->
    <!-- MULTI-ROLE DC HEALTH MONITORING              -->
    <!-- ============================================ -->
    <!-- Check DC Replication Health -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>dc-replication-health</tag>
      <command>powershell.exe -ExecutionPolicy Bypass -Command "repadmin /showrepl /csv | Select-String -Pattern 'fail|error|warning' -CaseSensitive:$false"</command>
      <interval>1h</interval>
      <run_on_start>yes</run_on_start>
      <timeout>90</timeout>
    </wodle>
    <!-- Monitor SYSVOL Replication -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>sysvol-replication</tag>
      <command>dfsrmig /getglobalstate</command>
      <interval>6h</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- Check FSMO Roles -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>fsmo-roles</tag>
      <command>netdom query fsmo</command>
      <interval>1d</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- Monitor ALL DC Services -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>dc-services</tag>
      <command>powershell.exe -ExecutionPolicy Bypass -Command "Get-Service NTDS,DNS,DHCPServer,IAS,CertSvc,KDC,Netlogon,W32Time,DFSR | Select-Object Name,Status | ConvertTo-Json -Compress"</command>
      <interval>5m</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- Check Time Synchronization -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>time-sync</tag>
      <command>w32tm /query /status</command>
      <interval>1h</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- Monitor Kerberos Tickets -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>kerberos-tickets</tag>
      <command>klist tickets</command>
      <interval>1h</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- Check DNS Zones -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>dns-zones</tag>
      <command>dnscmd /enumzones</command>
      <interval>1d</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- AD Database Size -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>ntds-size</tag>
      <command>powershell.exe -ExecutionPolicy Bypass -Command "(Get-Item 'C:\Windows\NTDS\ntds.dit').Length/1GB"</command>
      <interval>1d</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- Certificate Authority Health - NEW -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>ca-health</tag>
      <command>certutil -ping</command>
      <interval>30m</interval>
      <run_on_start>yes</run_on_start>
      <timeout>30</timeout>
    </wodle>
    <!-- CRL Status - NEW -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>crl-status</tag>
      <command>certutil -CRL</command>
      <interval>1h</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- DHCP Scope Statistics - NEW -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>dhcp-stats</tag>
      <command>powershell.exe -ExecutionPolicy Bypass -Command "Get-DhcpServerv4ScopeStatistics | ConvertTo-Json -Compress"</command>
      <interval>30m</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- NPS Health Check - NEW -->
    <wodle name="command">
      <disabled>no</disabled>
      <tag>nps-health</tag>
      <command>netsh nps show config</command>
      <interval>1h</interval>
      <run_on_start>yes</run_on_start>
      <timeout>60</timeout>
    </wodle>
    <!-- ============================================ -->
    <!-- ACTIVE RESPONSE                              -->
    <!-- ============================================ -->
    <active-response>
      <disabled>no</disabled>
      <ca_store>C:\Program Files (x86)\ossec-agent\etc\wpk_root.pem</ca_store>
      <repeated_offenders>60,120,240,480</repeated_offenders>
    </active-response>
    <!-- ============================================ -->
    <!-- LABELS FOR MULTI-ROLE DC                     -->
    <!-- ============================================ -->
    <labels>
      <label key="environment">production</label>
      <label key="os">windows_server_2025</label>
      <label key="role">domain_controller</label>
      <label key="services">ad,dns,dhcp,ca,nps</label>
      <label key="criticality">critical</label>
      <label key="compliance">cis,nist,iso27001,pci-dss</label>
      <label key="datacenter">primary</label>
    </labels>
  </agent_config>
